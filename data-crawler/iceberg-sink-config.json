{
  "name": "iceberg-sink-connector",
  "config": {
    "connector.class": "org.apache.iceberg.connect.IcebergSinkConnector",
    "tasks.max": "1",
    "topics": "lakehouse.trips,lakehouse.payment_types,lakehouse.vendors",
    "iceberg.catalog.type": "hadoop",
    "iceberg.catalog.warehouse": "s3a://lakehouse/warehouse",
    "iceberg.catalog.uri": "",
    "iceberg.catalog.hadoop.conf.fs.s3a.endpoint": "http://minio:9000",
    "iceberg.catalog.hadoop.conf.fs.s3a.access.key": "admin",
    "iceberg.catalog.hadoop.conf.fs.s3a.secret.key": "password",
    "iceberg.catalog.hadoop.conf.fs.s3a.path.style.access": "true",
    "iceberg.catalog.hadoop.conf.fs.s3a.impl": "org.apache.hadoop.fs.s3a.S3AFileSystem",
    "iceberg.table.namespace": "taxi_cdc",
    "iceberg.table.auto-create": "true",
    "iceberg.table.write-format": "parquet",
    "iceberg.table.commit.timeout-ms": "30000",
    "iceberg.table.commit.retry.num-retries": "3",
    "iceberg.control.commit.interval-ms": "10000",
    "iceberg.control.commit.timeout-ms": "30000",
    "iceberg.kafka.auto.offset.reset": "earliest",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "false",
    "value.converter.schemas.enable": "false",
    "transforms": "unwrap",
    "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState",
    "transforms.unwrap.drop.tombstones": "false",
    "transforms.unwrap.delete.handling.mode": "rewrite",
    "transforms.unwrap.add.fields": "op,source.ts_ms,source.db,source.table",
    "iceberg.table.partition.by": "hour(source_ts_ms)",
    "iceberg.table.sorted.by": "source_ts_ms",
    "iceberg.tables": "lakehouse.trips:taxi_cdc.trips_cdc,lakehouse.payment_types:taxi_cdc.payment_types_cdc,lakehouse.vendors:taxi_cdc.vendors_cdc"
  }
}
